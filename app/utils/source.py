from kamene.all import rdpcap

xmsrf = b'\xe5\xb0\x8f\xe7\xb1\xb3\xe6\x9c\x8d\xe5\x8a\xa1\xe6\xa1\x86\xe6\x9e\xb6\x00\x00'
qq = b'\x51\x51\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
wx = b'\xe5\xbe\xae\xe4\xbf\xa1\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
google_play = b'\x47\x6f\x6f\x67\x6c\x65\x20\x50\x6c\x61\x79\x20\xe6\x9c\x8d\xe5\x8a\xa1\x00\x00'
baidu = b'\xe5\x9c\xa8\xe5\x9f\x8e\xe5\x9c\xa8\xe6\x89\x8b\xe6\x9c\xba\xe6\x9c\x8d\xe5\x8a\xa1\xe5\x99\xa8\x00\x00'
QQmusic = b'\x51\x51\xe9\x9f\xb3\xe4\xb9\x90\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
wps = b'\x57\x50\x53\x20\x4f\x66\x66\x69\x63\x65\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
wangyimusic = b'\xe7\xbd\x91\xe6\x98\x93\xe4\xba\x91\xe9\x9f\xb3\xe4\xb9\x90\x00\x00\x00\x00\x00'
zhifubao = b'\xe6\x94\xaf\xe4\xbb\x98\xe5\xae\x9d\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'


def biaoqian(packet):
    raw_data = bytes(packet)
    # 提取最后24个字节
    last_24_bytes = raw_data[-24:-4]
    if last_24_bytes == xmsrf:
        return '小米输入法'
    elif last_24_bytes == qq:
        return 'QQ'
    elif last_24_bytes == wx:
        return '微信'
    elif last_24_bytes == google_play:
        return 'Google Play'
    elif last_24_bytes == QQmusic:
        return 'QQ音乐'
    elif last_24_bytes == baidu:
        return '百度'
    elif last_24_bytes == wps:
        return 'WPS'
    elif last_24_bytes == wangyimusic:
        return '网易云音乐'
    elif last_24_bytes == zhifubao:
        return '支付宝'
    else:
        return 'Other'
