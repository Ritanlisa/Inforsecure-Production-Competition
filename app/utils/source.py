from kamene.all import rdpcap

CN_Name = {b'\xe5\xb0\x8f\xe7\xb1\xb3\xe6\x9c\x8d\xe5\x8a\xa1\xe6\xa1\x86\xe6\x9e\xb6\x00\x00': '小米输入法',
           b'\x51\x51\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00': 'QQ',
           b'\xe5\xbe\xae\xe4\xbf\xa1\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00': '微信',
           b'\x47\x6f\x6f\x67\x6c\x65\x20\x50\x6c\x61\x79\x20\xe6\x9c\x8d\xe5\x8a\xa1\x00\x00': 'Google Play',
           b'\xe5\x9c\xa8\xe5\x9f\x8e\xe5\x9c\xa8\xe6\x89\x8b\xe6\x9c\xba\xe6\x9c\x8d\xe5\x8a\xa1\xe5\x99\xa8\x00\x00': '百度',
           b'\x51\x51\xe9\x9f\xb3\xe4\xb9\x90\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00': 'QQ音乐',
           b'\x57\x50\x53\x20\x4f\x66\x66\x69\x63\x65\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00': 'WPS',
           b'\xe7\xbd\x91\xe6\x98\x93\xe4\xba\x91\xe9\x9f\xb3\xe4\xb9\x90\x00\x00\x00\x00\x00': '网易云音乐',
           b'\xe6\x94\xaf\xe4\xbb\x98\xe5\xae\x9d\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00': '支付宝'
        }

def label(packet):
    raw_data = bytes(packet)
    # 谁教你这么写屎山的啊？
    last_24_bytes = raw_data[-24:-4] # 提取最后24个字节
    if last_24_bytes in CN_Name:
        return CN_Name[last_24_bytes]
    else:
        return '未知应用' # 不要中英文混合！

